@using Carnesia.Domain.OMS.Picklist.CreatePicklist

<MudPaper Class="px-16 pb-16 pt-10 ma-2 mt-10">
	<MudContainer Fixed="true">
		<MudGrid>
			<MudItem lg="3" md="6">
				<MudTextField T="string" Label="Order" Variant="Variant.Text"/>
			</MudItem>
			<MudItem lg="3" md="6">
				<MudDateRangePicker Label="Order Date" />
			</MudItem>
			<MudItem lg="3" md="6">
				<MudTextField T="string" Label="SKU" Variant="Variant.Text"/>
			</MudItem>
			<MudItem lg="3" md="6">
				<MudTextField T="string" Label="SKU Per Order" Variant="Variant.Text"/>
			</MudItem>
			<MudItem lg="3" md="6">
				<MudSelect T="string" Label="Order Source" AnchorOrigin="Origin.BottomCenter">
					<MudSelectItem Value="@("FB Order")" />
					<MudSelectItem Value="@("Website Order")" />
					<MudSelectItem Value="@("Admin Order")" />
				</MudSelect>
			</MudItem>
			<MudItem lg="3" md="6">
				<MudSelect T="string" Label="Shipping Area" AnchorOrigin="Origin.BottomCenter">
					<MudSelectItem Value="@("Inside Dhaka")" />
					<MudSelectItem Value="@("Dhaka Suburb")" />
					<MudSelectItem Value="@("Outside Dhaka")" />
				</MudSelect>
			</MudItem>
			<MudItem lg="3" md="6">
				<MudAutocomplete T="string" Label="Zone" ResetValueOnEmptyText="true" />
			</MudItem>
			<MudItem lg="3" md="6">
				<MudSelect T="string" Label="Offer Type" AnchorOrigin="Origin.BottomCenter">
					<MudSelectItem Value="@("Regular")" />
					<MudSelectItem Value="@("Achomka")" />
					<MudSelectItem Value="@("Big Sale")" />
				</MudSelect>
			</MudItem>
		</MudGrid>
		<div class="d-flex justify-end mt-3 mb-5">
			<MudButton Variant="Variant.Filled" Color="Color.Primary">Filter</MudButton>
		</div>
		 
		<MudTable Items="@Elements" MultiSelection="true"  @bind-SelectedItems="SelectedItems" Hover="true"  HorizontalScrollbar="true">
			<ColGroup>
				<col />
				<col />
				<col />
				<col />
				<col style="width:110px;"/>
				<col />
				<col />
				<col />
				<col />
				<col style="width:110px;"/>
				<col />
				<col />
				<col />
			</ColGroup>
			<HeaderContent>
				<MudTh></MudTh>
				<MudTh>Order Id</MudTh>
				<MudTh>Source</MudTh>
				<MudTh>Order Date</MudTh>
				<MudTh>Consumer Name</MudTh>
				<MudTh>Phone Number</MudTh>
				<MudTh>Area</MudTh>
				<MudTh>Zone</MudTh>
				<MudTh>Varified On</MudTh>
				<MudTh>Order Type</MudTh>
				<MudTh>Instructions</MudTh>
				<MudTh>CS/Ops Comment</MudTh>
			</HeaderContent>
			<RowTemplate>
				<MudTd DataLabel="">
					@if (!context.ShowDetails)
					{
						<MudIconButton Icon="@Icons.Material.Filled.Add" aria-label="Show" OnClick="() => ShowBtnPress(context.OrderId)" />
					}
					else if (context.ShowDetails)
					{
						<MudIconButton Icon="@Icons.Filled.Minimize" aria-label="Hide" OnClick="() => ShowBtnPress(context.OrderId)" />
					}
				</MudTd>
				<MudTd DataLabel="Order Id">@context.OrderId</MudTd>
				<MudTd DataLabel="Source">@context.Source</MudTd>
				<MudTd DataLabel="Order Date">@context.OrderDate</MudTd>
				<MudTd DataLabel="Consumer Name">@context.ConsumerName</MudTd>
				<MudTd DataLabel="Phone Number">@context.Phone</MudTd>
				<MudTd DataLabel="Area">@context.Area</MudTd>
				<MudTd DataLabel="Zone">@context.Zone</MudTd>
				<MudTd DataLabel="Varified On">@context.VarificationDate</MudTd>
				<MudTd DataLabel="Order Type">@context.OrderType</MudTd>
				<MudTd DataLabel="Instructions">@context.Instruction</MudTd>
				<MudTd DataLabel="CS/Ops Comment">@context.Comment</MudTd>
			</RowTemplate>
			<ChildRowContent>
				@if (context.ShowDetails)
				{
					<td colspan="13">
						<MudCard Elevation="0">
							<MudCardContent Class="pa-0">
								<MudTable Items="@context.Details" Context="DetailsContext" Hover="true" Elevation="0">
								   <HeaderContent>
									<MudTh>SKU</MudTh>
									<MudTh>Product Name</MudTh>
									<MudTh>Quantity</MudTh>
									<MudTh>Selling Price</MudTh>
									<MudTh>SubTotal</MudTh>
								   </HeaderContent>
								   <RowTemplate>
									<MudTd DataLabel="SKU">@DetailsContext.SKU</MudTd>
									<MudTd DataLabel="Product Name">@DetailsContext.ProductName</MudTd>
									<MudTd DataLabel="Quantity">@DetailsContext.QTY</MudTd>
									<MudTd DataLabel="Selling Price">@DetailsContext.SellingPrice</MudTd>
									<MudTd DataLabel="Subtotal">@DetailsContext.SubTotal</MudTd>
								   </RowTemplate>
								 </MudTable>
							</MudCardContent>
						</MudCard>
					</td>
				}
			</ChildRowContent>
			<PagerContent>
				<MudTablePager />
			</PagerContent>
		</MudTable>
	</MudContainer>
</MudPaper>

@code {
	protected override void OnInitialized()
	{
		AddData();
	}

	// Table Content
	private IEnumerable<CreatePicklistDTO> Elements = new List<CreatePicklistDTO>();
	private HashSet<CreatePicklistDTO> SelectedItems = new HashSet<CreatePicklistDTO>();


	private void AddData()
	{
		IList<CreatePicklistDTO> order = new List<CreatePicklistDTO>();
		IList<CreatePicklistDetailsDTO> details = new List<CreatePicklistDetailsDTO>();

		details.Add(new CreatePicklistDetailsDTO
		{
			SKU = "123asdf123",
			ProductName = "Ponds Face Wash",
			QTY = 2,
			SellingPrice = 50,
			SubTotal = 2*50
		});

		details.Add(new CreatePicklistDetailsDTO
		{
			SKU = "123asdf",
			ProductName = "Ponds Face Powder",
			QTY = 2,
			SellingPrice = 50,
			SubTotal = 2*50
		});

		order.Add(new CreatePicklistDTO
		{
			ShowDetails = false,
			OrderId = "1234567",
			Source = "Website",
			OrderDate = "01-07-2020",
			ConsumerName = "Nafis",
			Phone = "01990025740",
			Area = "Outside Dhaka",
			Zone = "Chittagong",
			VarificationDate = "03-07-2020",
			OrderType = "Regular",
			Instruction = "Deliver Before 1pm!",
			Comment = "Customer want it on urgent basis",
			Details = details
		});

		details.Clear();

		details.Add(new CreatePicklistDetailsDTO
		{
			SKU = "123asdfsdsfg",
			ProductName = "Ponds Face Powder",
			QTY = 2,
			SellingPrice = 50,
			SubTotal = 2*50
		});

		details.Add(new CreatePicklistDetailsDTO
		{
			SKU = "123asdfrfrgf",
			ProductName = "Ponds Face Powder",
			QTY = 2,
			SellingPrice = 50,
			SubTotal = 2*50
		});

		order.Add(new CreatePicklistDTO
		{
			ShowDetails = false,
			OrderId = "123456723",
			Source = "Website",
			OrderDate = "01-07-2020",
			ConsumerName = "Nafis",
			Phone = "01990025740",
			Area = "Outside Dhaka",
			Zone = "Chittagong",
			VarificationDate = "03-07-2020",
			OrderType = "Regular",
			Instruction = "Deliver Before 1pm!",
			Comment = "Customer want it on urgent basis",
			Details = details
		});

		Elements = order;
	}


	// Show Details
	private void ShowBtnPress(string orderId)
	{
		CreatePicklistDTO tmpElements = Elements.First(f => f.OrderId == orderId);
		tmpElements.ShowDetails = !tmpElements.ShowDetails;
	}

}
